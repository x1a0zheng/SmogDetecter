(function(e){function t(t){for(var n,a,i=t[0],s=t[1],u=t[2],l=0,f=[];l<i.length;l++)a=i[l],Object.prototype.hasOwnProperty.call(c,a)&&c[a]&&f.push(c[a][0]),c[a]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);d&&d(t);while(f.length)f.shift()();return r.push.apply(r,u||[]),o()}function o(){for(var e,t=0;t<r.length;t++){for(var o=r[t],n=!0,a=1;a<o.length;a++){var s=o[a];0!==c[s]&&(n=!1)}n&&(r.splice(t--,1),e=i(i.s=o[0]))}return e}var n={},c={app:0},r=[];function a(e){return i.p+"js/"+({}[e]||e)+"."+{"chunk-2d0c72f1":"113588a4"}[e]+".js"}function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.e=function(e){var t=[],o=c[e];if(0!==o)if(o)t.push(o[2]);else{var n=new Promise((function(t,n){o=c[e]=[t,n]}));t.push(o[2]=n);var r,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=a(e);var u=new Error;r=function(t){s.onerror=s.onload=null,clearTimeout(l);var o=c[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+n+": "+r+")",u.name="ChunkLoadError",u.type=n,u.request=r,o[1](u)}c[e]=void 0}};var l=setTimeout((function(){r({type:"timeout",target:s})}),12e4);s.onerror=s.onload=r,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/SmogDetecter/",i.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=u;r.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"3a80":function(e,t,o){"use strict";o("79aa")},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("7a23");function c(e,t){var o=Object(n["resolveComponent"])("router-view");return Object(n["openBlock"])(),Object(n["createBlock"])(o)}o("58f3");const r={};r.render=c;var a=r,i=(o("d3b7"),o("3ca3"),o("ddb0"),o("6c02")),s=Object(n["withScopeId"])("data-v-59b1ae8d");Object(n["pushScopeId"])("data-v-59b1ae8d");var u={class:"home"},l={class:"background"},d={class:"gradient"},f={class:"main-container"},p={class:"middle-container"},h={class:"temperature-container"},m={class:"temperature-number"},b=Object(n["createVNode"])("div",{class:"temperature-sign"}," ℃ ",-1),g={class:"middle-weather-container"},v={class:"weather-text"},y={class:"bottom-container"},O={class:"tody-aoi"},j={class:"bottom-container-list"};Object(n["popScopeId"])();var w=s((function(e,t,o,c,r,a){var i=Object(n["resolveComponent"])("city-component"),s=Object(n["resolveComponent"])("weather-icon"),w=Object(n["resolveComponent"])("future-weather-info-item");return Object(n["openBlock"])(),Object(n["createBlock"])("div",u,[Object(n["createVNode"])("div",l,[Object(n["createVNode"])("div",d,[Object(n["createVNode"])("div",f,[Object(n["createVNode"])(i),Object(n["createVNode"])("div",p,[Object(n["createVNode"])("div",h,[Object(n["createVNode"])("div",m,Object(n["toDisplayString"])(r.weather.feelsLike),1),b]),Object(n["createVNode"])("div",g,[Object(n["createVNode"])(s,{icon:r.weather.icon},null,8,["icon"]),Object(n["createVNode"])("div",v,Object(n["toDisplayString"])(r.weather.text),1)])]),Object(n["createVNode"])("div",y,[Object(n["createVNode"])("div",O,"空气指数"+Object(n["toDisplayString"])(r.air.aqi)+" "+Object(n["toDisplayString"])(r.air.category),1),Object(n["createVNode"])("div",j,[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(r.futureInfo,(function(e){return Object(n["openBlock"])(),Object(n["createBlock"])(w,{key:e,text:e.text,maxTemp:e.maxTemp,minTemp:e.minTemp,dayIcon:e.dayIcon,nightIcon:e.nightIcon},null,8,["text","maxTemp","minTemp","dayIcon","nightIcon"])})),128))]),Object(n["createVNode"])("div",{class:"info-button",onClick:t[1]||(t[1]=function(t){return e.$router.push("/info")})},"天气详情")])])])])])})),I=o("b85c"),S=Object(n["withScopeId"])("data-v-30535df8"),k=S((function(e,t,o,c,r,a){return Object(n["openBlock"])(),Object(n["createBlock"])("div",{class:"city-component",onClick:t[1]||(t[1]=function(){return a.relocate&&a.relocate.apply(a,arguments)})},Object(n["toDisplayString"])(r.cityName),1)})),C=(o("99af"),o("b0c0"),{200:"请求成功",204:"无数据",400:"参数错误",401:"认证失败",402:"超过访问次数",403:"无权限",404:"数据或地区不存在",429:"每分钟访问次数受限",500:"无响应"}),N=function(e,t){return new Promise((function(o,n){var c=new XMLHttpRequest;null===c&&n(new Error("Browser does not support XMLHttpRequest!")),c.onload=function(){try{var e=JSON.parse(c.responseText);"200"===e.code?o(e):n(new Error("API return an error("+e.code+"): "+C[e.code]))}catch(t){n(t)}},c.onerror=function(){n(new Error("Fail to call API"))};var r="?";for(var a in t)r+=a+"="+encodeURIComponent(t[a])+"&";c.open("GET",e+r),c.setRequestHeader("Accept-Language","*"),c.send()}))},x={name:"CityComponent",data:function(){return{cityName:"未知城市",geolocationTimeStamp:0,allowRelocate:!1}},mounted:function(){this.getLocationPos()},unmounted:function(){},methods:{relocate:function(){this.allowRelocate&&this.getLocationPos()},getLocationPos:function(){var e=this;this.cityName="正在获取城市...",this.allowRelocate=!1;var t=this;setTimeout((function(){navigator.geolocation.getCurrentPosition((function(t){console.log("yes: "),console.log(t);try{e.onLocationDetected(t)}catch(o){console.error(o)}}),(function(e){var o={1:"位置服务拒绝",2:"获取不到位置信息",3:"超时",4:"未知错误"};console.error("Can't get the location: "),console.error(e.code),t.allowRelocate=!0,t.cityName="获取位置失败",t.$message({message:"无法获取当前位置。"+"[".concat(e.code,"]: ").concat(o[e.code]),type:"error",duration:1e4,showClose:!0})}),{enableHighAccuracy:!1,timeout:1e4})}),0)},onLocationDetected:function(e){if(!(this.geolocationTimeStamp>e.timestamp)){this.allowRelocate=!0,this.geolocationTimeStamp=e.timestamp,this.$store.commit("setLocationPos",e.coords);var t=this;N("https://geoapi.qweather.com/v2/city/lookup",{location:String(e.coords.longitude)+","+String(e.coords.latitude),key:this.$store.state.key}).then((function(e){e.location.length>0?(t.cityName=e.location[0].name,t.$store.commit("setCityInfo",e.location[0])):(console.error("Unkown location."),t.$message({message:"当前位置不知道是哪。",type:"warning",duration:1e4,showClose:!0}),t.cityName="未知城市",t.$store.commit("clearCityInfo"))})).catch((function(e){console.error("Fail to get city info."+e),t.$message({message:"无法获取当前城市信息。"+e,type:"error",duration:1e4,showClose:!0}),t.cityName="未知城市"}))}}}};o("e1c6");x.render=k,x.__scopeId="data-v-30535df8";var T=x,P=Object(n["withScopeId"])("data-v-75b3246b");Object(n["pushScopeId"])("data-v-75b3246b");var D={class:"future-weather-info-item"},V=Object(n["createTextVNode"])(" | "),$={class:"item-right"};Object(n["popScopeId"])();var L=P((function(e,t,o,c,r,a){var i=Object(n["resolveComponent"])("weather-icon");return Object(n["openBlock"])(),Object(n["createBlock"])("div",D,[Object(n["createVNode"])(i,{icon:o.dayIcon},null,8,["icon"]),V,Object(n["createVNode"])(i,{icon:o.nightIcon},null,8,["icon"]),Object(n["createVNode"])("div",null,Object(n["toDisplayString"])(o.text),1),Object(n["createVNode"])("div",$,Object(n["toDisplayString"])(o.maxTemp)+"° / "+Object(n["toDisplayString"])(o.minTemp)+"°",1)])})),B=Object(n["withScopeId"])("data-v-f0dbfb8c");Object(n["pushScopeId"])("data-v-f0dbfb8c");var _={ref:"box",class:"weather-icon"};Object(n["popScopeId"])();var q=B((function(e,t,o,c,r,a){return Object(n["openBlock"])(),Object(n["createBlock"])("div",_,null,512)})),A={name:"WeatherIcon",props:{icon:String},watch:{icon:function(e){this.setIcon(e)}},mounted:function(){this.setIcon(this.icon)},methods:{setIcon:function(e){this.$refs.box.style='background-image:url("'.concat(window.location.origin+"/SmogDetecter/"+this.$route.path,"weather_icons/64/").concat(e,'.png");')}}};o("794e");A.render=q,A.__scopeId="data-v-f0dbfb8c";var M=A,R={components:{WeatherIcon:M},name:"FutureWeatherInfoItem",props:{text:String,maxTemp:String,minTemp:String,dayIcon:String,nightIcon:String},methods:{}};o("3a80");R.render=L,R.__scopeId="data-v-75b3246b";var E=R,F={name:"Home",components:{"city-component":T,"future-weather-info-item":E,"weather-icon":M},data:function(){return{weather:{feelsLike:"13",text:"神秘天气"},air:{aqi:3,category:"还行"},futureInfo:[]}},computed:{locationPos:function(){return this.$store.state.locationPos}},watch:{locationPos:function(e){if(null!=e){var t=e.longitude+","+e.latitude;this.getCurrentCityWeatherInfo(t),this.getCurrentCityAirInfo(t),this.getFutureInfo(t)}}},methods:{getCurrentCityWeatherInfo:function(e){var t=this;N("https://devapi.qweather.com/v7/weather/now",{key:this.$store.state.key,location:e}).then((function(e){t.weather=e.now})).catch((function(e){console.error("Can't get current city weather info."+e),t.$message({message:"无法获取当前的天气信息。"+e,type:"error",duration:1e4,showClose:!0}),t.weather.feelsLike="NA",t.weather.text="Unknown"}))},getCurrentCityAirInfo:function(e){var t=this;N("https://devapi.qweather.com/v7/air/now",{key:this.$store.state.key,location:e}).then((function(e){t.air=e.now})).catch((function(e){console.error("Can't get current city air info."+e),t.$message({message:"无法获取当前空气质量信息。"+e,type:"error",duration:1e4,showClose:!0}),t.air.aqi="NA",t.air.category="Unknown"}))},dateToString:function(e){var t=String(e.getMonth()+1);1===t.length&&(t="0"+t);var o=String(e.getDate());return 1===o.length&&(o="0"+o),e.getFullYear()+"-"+t+"-"+o},getFutureInfo:function(e){var t=new Date,o=this.dateToString(t);t.setDate(t.getDate()+1);var n=this.dateToString(t);t.setDate(t.getDate()+1);var c=this.dateToString(t),r={};r[o]="今天",r[n]="明天",r[c]="后天";var a=this;N("https://devapi.qweather.com/v7/weather/3d",{key:this.$store.state.key,location:e}).then((function(e){var t,o=[],n=Object(I["a"])(e.daily);try{for(n.s();!(t=n.n()).done;){var c=t.value;o.push({text:r[c.fxDate]+" · "+c.textDay+"/"+c.textNight,maxTemp:c.tempMax,minTemp:c.tempMin,dayIcon:c.iconDay,nightIcon:c.iconNight})}}catch(i){n.e(i)}finally{n.f()}a.futureInfo=o})).catch((function(e){console.error("Can't get future weather info."+e),a.$message({message:"无法获取未来天气预报信息。"+e,type:"error",duration:1e4,showClose:!0}),a.futureInfo=[]}))}}};o("7c7f");F.render=w,F.__scopeId="data-v-59b1ae8d";var H=F,W=[{path:"/",name:"Home",component:H},{path:"/info",name:"WeatherInfo",component:function(){return o.e("chunk-2d0c72f1").then(o.bind(null,"5011"))}}],U=Object(i["a"])({history:Object(i["b"])("/SmogDetecter/"),routes:W}),J=U,X=o("5502"),G=Object(X["a"])({state:{key:"215e1f6839c547e1ae69f1a88aefd915",locationPos:null,cityInfo:null},mutations:{setLocationPos:function(e,t){e.locationPos=t},setCityInfo:function(e,t){e.cityInfo=t},clearCityInfo:function(e){e.cityInfo=null}},actions:{},modules:{}}),Y=(o("7f17"),o("f3fc"),o("6573")),z=o.n(Y),K=(o("4af4"),o("44fb")),Q=o.n(K),Z=o("3ef0"),ee=o.n(Z),te=o("51d4"),oe=o.n(te),ne=function(e){oe.a.use(ee.a),e.use(Q.a),e.use(z.a)},ce=Object(n["createApp"])(a);ne(ce),ce.use(G).use(J).mount("#app")},"58f3":function(e,t,o){"use strict";o("9aaf")},"794e":function(e,t,o){"use strict";o("79e4")},"79aa":function(e,t,o){},"79e4":function(e,t,o){},"7c7f":function(e,t,o){"use strict";o("cc8d")},"9aaf":function(e,t,o){},cc8d:function(e,t,o){},dad2:function(e,t,o){},e1c6:function(e,t,o){"use strict";o("dad2")}});
//# sourceMappingURL=app.cd7e332b.js.map